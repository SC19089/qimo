<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Yaru Tian" />

<meta name="date" content="2020-01-02" />

<title>Introduction to SC19089</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SC19089</h1>
<h4 class="author">Yaru Tian</h4>
<h4 class="date">2020-01-02</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>SC19089</strong> is a simple R package developed to compare the performance of R and R++ (implemented through the R package <em>Rcpp</em>) for the ‘Statistical Computing’ course. Three functions are considered, namely, <em>sse</em> (Use stratified sampling to estimate the integration.) and <em>xt</em> (estimate the number of events in possion process) and <em>Brown</em>(plot of st Brownian Motion). For each function, both R versions are produced.</p>
<p>The R package ‘microbenchmark’ can be used to benchmark the above R and C++ functions.</p>
</div>
<div id="benchmarking-sser-and-ssec" class="section level2">
<h2>Benchmarking <em>sseR</em> and <em>sseC</em></h2>
<p>The source R code for <em>sseR</em> is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">sseR=<span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb1-2" title="2">f=<span class="cf">function</span>(x){x<span class="op">^</span>n<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb1-3" title="3">s=<span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb1-5" title="5">  s[i]=<span class="kw">mean</span>(<span class="kw">f</span>(<span class="kw">runif</span>(<span class="dv">4</span>,(i<span class="dv">-1</span>)<span class="op">*</span><span class="fl">0.25</span>,i<span class="op">*</span><span class="fl">0.25</span>)))</a>
<a class="sourceLine" id="cb1-6" title="6">}</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">mean</span>(s)</a>
<a class="sourceLine" id="cb1-8" title="8">}</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">sseR</span>(<span class="dv">0</span>);<span class="kw">sseR</span>(<span class="dv">1</span>);<span class="kw">sseR</span>(<span class="fl">1.5</span>)</a></code></pre></div>
<pre><code>## [1] 0.6278022</code></pre>
<pre><code>## [1] 0.2605033</code></pre>
<pre><code>## [1] 0.1999455</code></pre>
<p>the <em>R</em> are known to be slow. On the other hand, the following <em>Rcpp</em> code is much faster. The source code for <em>sseC</em> is as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">cppFunction</span>(<span class="st">&#39;double sseC(double n){</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  NumericVector s(4);</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st">  for(int i=0;i&lt;4;i++){</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">  NumericVector x=runif(4,i*0.25,(i+1)*0.25);</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="st">  NumericVector t(4);</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="st">  for(int j=0;j&lt;4;j++){</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="st">  t[j]=pow(x[j],n)*exp(-x[j]);</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="st">  }</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="st">  s[i]=mean(t);}</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="st">return mean(s);</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="st">  </span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb5-14" title="14"><span class="kw">sseC</span>(<span class="dv">0</span>);<span class="kw">sseC</span>(<span class="dv">1</span>);<span class="kw">sseC</span>(<span class="fl">1.5</span>)</a></code></pre></div>
<pre><code>## [1] 0.617115</code></pre>
<pre><code>## [1] 0.264805</code></pre>
<pre><code>## [1] 0.1952206</code></pre>
<p>In order to empirically benchmark <em>seeR</em> and <em>seeC</em>,we have n=5. The R code for benchmark <em>vaccR</em> and <em>vaccC</em> is as follows.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb9-2" title="2">tm2 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="dt">vR =</span> <span class="kw">sseR</span>(<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="dt">vC =</span> <span class="kw">sseC</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb9-5" title="5">)</a>
<a class="sourceLine" id="cb9-6" title="6">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(tm2)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">expr</th>
<th align="right">lq</th>
<th align="right">median</th>
<th align="right">uq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">vR</td>
<td align="right">34.0</td>
<td align="right">34.6</td>
<td align="right">35.15</td>
</tr>
<tr class="even">
<td align="left">vC</td>
<td align="right">3.1</td>
<td align="right">3.4</td>
<td align="right">3.60</td>
</tr>
</tbody>
</table>
<p>The above results show an evident computational speed gain of C++ against R.</p>
</div>
<div id="benchmarking-xtr-and-xtc" class="section level2">
<h2>Benchmarking <em>xtR</em> and <em>xtC</em></h2>
<p>The source R code for <em>xtR</em> is as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">xtR=<span class="cf">function</span>(N,lambda){</a>
<a class="sourceLine" id="cb10-2" title="2">x=<span class="kw">rexp</span>(N,lambda)</a>
<a class="sourceLine" id="cb10-3" title="3">Tn=<span class="kw">vector</span>(<span class="dt">length=</span>N)</a>
<a class="sourceLine" id="cb10-4" title="4">Tn[<span class="dv">1</span>]=x[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb10-6" title="6">  Tn[i]=Tn[i<span class="dv">-1</span>]<span class="op">+</span>x[i]</a>
<a class="sourceLine" id="cb10-7" title="7">} <span class="co">#the total time</span></a>
<a class="sourceLine" id="cb10-8" title="8">t=<span class="dv">10</span></a>
<a class="sourceLine" id="cb10-9" title="9">i=<span class="dv">1</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb10-11" title="11">  <span class="cf">if</span>(Tn[i]<span class="op">&lt;=</span>t<span class="op">&amp;&amp;</span>Tn[i<span class="op">+</span><span class="dv">1</span>]<span class="op">&gt;</span>t){</a>
<a class="sourceLine" id="cb10-12" title="12">    xt=i</a>
<a class="sourceLine" id="cb10-13" title="13">  }</a>
<a class="sourceLine" id="cb10-14" title="14">}</a>
<a class="sourceLine" id="cb10-15" title="15">xt</a>
<a class="sourceLine" id="cb10-16" title="16">}</a>
<a class="sourceLine" id="cb10-17" title="17">t=<span class="kw">numeric</span>(<span class="fl">1e3</span>)</a>
<a class="sourceLine" id="cb10-18" title="18"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="fl">1e3</span>){</a>
<a class="sourceLine" id="cb10-19" title="19">  t[i]=<span class="kw">xtR</span>(<span class="dv">100</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-20" title="20">}</a>
<a class="sourceLine" id="cb10-21" title="21"><span class="kw">plot</span>(t,<span class="dt">ylab =</span> <span class="st">&quot;xt&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">round</span>(<span class="kw">mean</span>(t))</a></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>The source R code for <em>xtC</em> is as follows:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">cppFunction</span>(<span class="st">&#39; NumericVector xtC(int N,double lambda){</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">NumericVector x=rexp(N,lambda);</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">NumericVector Tn(N);</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">NumericVector xt(1);</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="st">Tn[0]=x[0];</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="st">for(int i=1;i&lt;N;i++){</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="st">  Tn[i]=Tn[i-1]+x[i];</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="st">} </span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="st">for(int i=0;i&lt;N;i++){</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="st"> int t=10;</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="st">  if(Tn[i]&lt;=t&amp;&amp;Tn[i+1]&gt;t){</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="st">   xt=i;}}</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="st">return xt;</span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb13-16" title="16">t=<span class="kw">numeric</span>(<span class="fl">1e3</span>)</a>
<a class="sourceLine" id="cb13-17" title="17"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="fl">1e3</span>){</a>
<a class="sourceLine" id="cb13-18" title="18">  t[i]=<span class="kw">xtC</span>(<span class="dv">100</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-19" title="19">}</a>
<a class="sourceLine" id="cb13-20" title="20"><span class="kw">plot</span>(t,<span class="dt">ylab =</span> <span class="st">&quot;xt&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">round</span>(<span class="kw">mean</span>(t))</a></code></pre></div>
<pre><code>## [1] 9</code></pre>
<p>The R code for benchmarking <em>xtR</em> and <em>xtC</em> is as follows.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">tm2 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="dt">vR =</span> <span class="kw">xtR</span>(<span class="dv">100</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb16-3" title="3">  <span class="dt">vC =</span> <span class="kw">xtC</span>(<span class="dv">100</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-4" title="4">)</a>
<a class="sourceLine" id="cb16-5" title="5">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(tm2)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">expr</th>
<th align="right">lq</th>
<th align="right">median</th>
<th align="right">uq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">vR</td>
<td align="right">21.7</td>
<td align="right">22.0</td>
<td align="right">22.6</td>
</tr>
<tr class="even">
<td align="left">vC</td>
<td align="right">4.8</td>
<td align="right">5.2</td>
<td align="right">5.5</td>
</tr>
</tbody>
</table>
<p>The results again show an evident computational speed gain of C++ against R. The source R code for <em>Brown</em> is as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">library</span>(e1071) </a>
<a class="sourceLine" id="cb17-2" title="2">Brown=<span class="cf">function</span>(t,n){</a>
<a class="sourceLine" id="cb17-3" title="3">N=<span class="dv">1000</span> </a>
<a class="sourceLine" id="cb17-4" title="4">m=n<span class="dv">-1</span></a>
<a class="sourceLine" id="cb17-5" title="5">time=<span class="kw">seq</span>(<span class="dv">0</span>,t,<span class="dt">length=</span>N) </a>
<a class="sourceLine" id="cb17-6" title="6">path=<span class="kw">rwiener</span>(<span class="dt">end=</span><span class="dv">1</span>,<span class="dt">frequency=</span>N) </a>
<a class="sourceLine" id="cb17-7" title="7"><span class="kw">plot</span>(time,path,<span class="dt">xlab=</span><span class="st">&quot;time&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot; Standard BM&quot;</span>)</a>
<a class="sourceLine" id="cb17-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ </a>
<a class="sourceLine" id="cb17-9" title="9">  path=<span class="kw">rwiener</span>(<span class="dt">end=</span><span class="dv">1</span>,<span class="dt">frequency=</span>N) </a>
<a class="sourceLine" id="cb17-10" title="10">  <span class="kw">lines</span>(time,path)</a>
<a class="sourceLine" id="cb17-11" title="11">}</a>
<a class="sourceLine" id="cb17-12" title="12">}</a>
<a class="sourceLine" id="cb17-13" title="13"><span class="kw">Brown</span>(<span class="dv">1</span>,<span class="dv">6</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="all-hw" class="section level2">
<h2>all hw</h2>
<p>hw 9.29</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># 3.4</span></a>
<a class="sourceLine" id="cb18-2" title="2">n=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb18-3" title="3">u=<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb18-4" title="4"></a>
<a class="sourceLine" id="cb18-5" title="5">Sigma1=.<span class="dv">05</span></a>
<a class="sourceLine" id="cb18-6" title="6">x=(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">*</span>Sigma1<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="st">&quot;sigma=0.05&quot;</span>)</a>
<a class="sourceLine" id="cb18-8" title="8">y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb18-9" title="9"><span class="kw">lines</span>(y,(y<span class="op">/</span>Sigma1<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(Sigma1<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">Sigma2=.<span class="dv">1</span></a>
<a class="sourceLine" id="cb19-2" title="2">x=(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">*</span>Sigma2<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-3" title="3"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="st">&quot;sigma=0.1&quot;</span>)</a>
<a class="sourceLine" id="cb19-4" title="4">y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb19-5" title="5"><span class="kw">lines</span>(y,(y<span class="op">/</span>Sigma2<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(Sigma2<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">Sigma3=.<span class="dv">2</span></a>
<a class="sourceLine" id="cb20-2" title="2">x=(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">*</span>Sigma3<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="st">&quot;sigma=0.2&quot;</span>)</a>
<a class="sourceLine" id="cb20-4" title="4">y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb20-5" title="5"><span class="kw">lines</span>(y,(y<span class="op">/</span>Sigma3<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(Sigma3<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">Sigma4=.<span class="dv">5</span></a>
<a class="sourceLine" id="cb21-2" title="2">x=(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">*</span>Sigma4<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="st">&quot;sigma=0.5&quot;</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="kw">lines</span>(y,(y<span class="op">/</span>Sigma4<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(Sigma4<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># 3.11</span></a>
<a class="sourceLine" id="cb22-2" title="2">n=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb22-3" title="3">x1=<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-4" title="4">x2=<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-5" title="5">u=<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb22-6" title="6">p=<span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-7" title="7">k=<span class="kw">as.integer</span>(u <span class="op">&lt;</span><span class="st"> </span>p)</a>
<a class="sourceLine" id="cb22-8" title="8">y=k <span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>k) <span class="op">*</span><span class="st"> </span>x2 </a>
<a class="sourceLine" id="cb22-9" title="9"><span class="kw">hist</span>(y,<span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">main =</span> <span class="st">&quot;y&quot;</span>)</a>
<a class="sourceLine" id="cb22-10" title="10"><span class="kw">lines</span>(<span class="kw">density</span>(y))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6OgA6Ojo6OpA6kLY6kNtmAABmADpmOgBmtv+QOgCQZgCQ27aQ2/+2ZgC2/7a2///bkDrb2//b////tmb/25D/27b//7b//9v///8UbHQHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIeElEQVR4nO2dbZujJhSGnZ2dbbeT6aZdWzumif//X65oMskY4QE5cNA895fEKxHwvgB5E6uOOKm0E1A6FASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBA0YJO++qr+Wyr6odWGooW1DXVl3/7j3r8UKFsQYcXk3WOuzEjqVC2oLGMaZawwgWNZayunt/VUlC4IFPG+hL2qpeCwgWZMtZUTz/1UlC4oL6MPf2mWcKKF9SXsUqzhBUvqC9jio2grnxB5h6v1wjq1iFIrxHUlS/o/z91S1jhgvomkG4VvQJBT3/oJqFsQQVAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggBhgsxEsEF3qiorQYKayxxVqzxZlZEQQaf9h5ZGc0VKVkIEHXcfs+TtwxQy5iBAYB10zkKsgywMiwl6kuWfakhPSW2PktLSfSSnoFQVlJTumpqqnGQtSElbJVuXW919UScsJXVVvR6+v9/e8CXSMCU4XQkJSkjdV871kHtEb/PTfLNaQUO+OXwzgkQbitXMZzG1UJgg0/o5/dclykGfPtcoqGsu+WZUdRPKbfWxNA2TklaIobBkNOPtq7UuXZYRNFNpqyEceYSganJcyD2/YEF3nyosjLyx3MWWC6omx931TrZGQaLB2QRdDFHQ5MybwqZ/xy9FUDU5vnxVb1ULz2pIC9LvdgjPaiwVVE2O7T/mRnhM+rEFecxqyAvqj1YjKF0Omipx/ZoZ4VmNBIKURz6EZzUeXVCa4CgInTQ1IhGoFDKRRw6YbV9QXHAUFHjS3bGmIQoCUBDgI26ZreY2LMi0k+P3yVhyKXfXf3+saOhz1NGOti5oVBQxrbxxQW1ldjM67ZfPK29ZkOmIjmYiViZsWNBxJ7EqasGV3F/+zLGeoaugt9FP3MKWBxBkmzMNDC7klDUIqq/98dy3+XUIuuYgoeBCzvAQpGdIfTzoMQRFBLcOQcfd62U8Pu5hua0K8mNcmdjKzs1vTtAwZWhdSB58HXMXX6ggc/mN80Ee84+zGrGZ1RUJqp/fDy9fu9o+bGYEHV4GQWJz876C1Azd9MV+DMt7HV0NzRxUhqC6l+Poaow3uq/d/ULy++BCol+HoL5sHXfP78edc2TabM/70/FE5pYFDdd+2seN3KcTpGVIuSVNQT7/X4kgkX05Aq9i/tILFVRDMx/dNbvGDQuy3rlvOO2RxISClAx9agdB4E1uw4L8bvCWR+kWDphZrvzuWPP5umts9scIFwUX8O/AHKQkSGPALEyQTlHTbAfZssQWBMU9cQgqlVIF9YXs+b2OWyHkKejzn30FqTSIbirpp5+N6c1nmDhcpSDzpIoZBssx9Ty50HUIMg1FI8i5eEHoicOlgjRGhu5yUO0YtZd64nCVgs51UONoLoo9L7ZOQWNT0bWKSuyJw8l1+gsavpbbDpLNQRsUJPbE4SoFjX0xsL5V6InD5YLMdx1B9Zg5msi19v6CJtnCFUgJgtpL5XyeWg4NJWysJkJQl3tN8BjbzWiZY27eOziff61L0E0PLFdXY6mg3M/+XAQJ7RRNQV7BefxrUvE6A6ncP6eFggBrFJTV0EUQnDMNCQ7/a3JjcgdSgKDMwUUKylrI1ikoo6FVCsqZhXQETVo2IJAZQfkMrVNQxiy0UkH5DCnVQc6TKEhCUC5DaxWULQvJxBM2YBa6odL83zMZ0shBsYKyrjgLC11k6vmuq7CwN59nP+6g0GWmnqUE5dmPOyR0mYnD+57C4vGgHMUsJGSZqWdBQdfjdIqy56CZjkKsoKSVdmAdFD31PNcMFshBw2eSSjsstOip59ld/IUEpam087aD5i9BSlCSlyhkEQRqCTFBKV6ikKWhOK0ckgkaFKlW0ssaitP+d0JB4jf8LLf5saVi/ZeooPuuXhxZGorVJNWJBYnmojw5yD3GKp6D3Mwm0YpMQ/EmdpS8UkgiKP27nssjXTd4I1AQYKGguIV6ayJJDtKtfhElCIr7Pe7n2NPj/i4T6HYFeW6A8rCCcGfVL9CtCvLoavgFulVB3mthH1UQcxACz2r4BbpZQb6d1ccV9IBQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQCpBrq3QhpFt23hJ69wFy3mqR9SHlyrwfbuJBLWOEZHTvjfQWNJptqFprYacp3pE3fY/gfc+TEkjaNjU0/bjuAPP/NzsOGhp3YHGdapH1GPoYbPCaQQ1z3+hBSDz2cTDgO1Uj6gP38LfwpdEUJ8QV0UwML+F/ngJYHsM1+77zqjbL//sQl/imEKQyclIkGVUe8wcziziHBB3R92YGc/Ad6ukEIQ29OzMRdrraCDIdqpH1M2TR/6ckEDQUEzcgqyZABcx54QKiHqs28K2aZMVNLyOvTkvM5lJxvl17fa99mAl7d6mzxG1YRQfVlVrNBQd+8WC27zrVI+ox6lh9SI24BB0eHFkAndD0XmqR9SmirqZH/ZBQdC5HFgsNK6uhvtUHPXwik/92/ymoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoClC5oWEvVRL25M47SBbXDutQl734VonRBZtXckvXfYpQuyJQx904qiSleUF/G6rj3T8dRvKDj299viiWsfEGn/e+qG6MWLyj6De+RlC9I9R62CkHfVbceLl9Qo1rCihd0eFHeu7p0QepQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMAvv0tDJ3wG4cMAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">u1=<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb23-2" title="2">k1=<span class="kw">as.integer</span>(u1<span class="op">&lt;</span>.<span class="dv">75</span>)</a>
<a class="sourceLine" id="cb23-3" title="3">y1=k1<span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>k1) <span class="op">*</span><span class="st"> </span>x2 </a>
<a class="sourceLine" id="cb23-4" title="4"><span class="kw">hist</span>(y1,<span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">main =</span> <span class="st">&quot;p=0.75&quot;</span>)</a>
<a class="sourceLine" id="cb23-5" title="5"><span class="kw">lines</span>(<span class="kw">density</span>(y1),<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">u2=<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb24-2" title="2">k2=<span class="kw">as.integer</span>(u1<span class="op">&lt;</span>.<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb24-3" title="3">y2=k2<span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>k2) <span class="op">*</span><span class="st"> </span>x2 </a>
<a class="sourceLine" id="cb24-4" title="4"><span class="kw">hist</span>(y2,<span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">main =</span> <span class="st">&quot;p=0.6&quot;</span>)</a>
<a class="sourceLine" id="cb24-5" title="5"><span class="kw">lines</span>(<span class="kw">density</span>(y2),<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># 3.18</span></a>
<a class="sourceLine" id="cb25-2" title="2">X=<span class="cf">function</span>(n,d,Sigma){</a>
<a class="sourceLine" id="cb25-3" title="3">  mu=<span class="kw">rep</span>(<span class="dv">0</span>,d)</a>
<a class="sourceLine" id="cb25-4" title="4">  ev=<span class="kw">eigen</span>(Sigma,<span class="dt">symmetric =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb25-5" title="5">  lambda =<span class="st"> </span>ev<span class="op">$</span>values</a>
<a class="sourceLine" id="cb25-6" title="6">  V =<span class="st"> </span>ev<span class="op">$</span>vectors</a>
<a class="sourceLine" id="cb25-7" title="7">  C =<span class="st"> </span>V <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(lambda)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V)</a>
<a class="sourceLine" id="cb25-8" title="8">  Z =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>d), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> d)</a>
<a class="sourceLine" id="cb25-9" title="9">  X =<span class="st"> </span>Z <span class="op">%*%</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(mu, n, d, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb25-10" title="10">  X</a>
<a class="sourceLine" id="cb25-11" title="11">}</a>
<a class="sourceLine" id="cb25-12" title="12">t=<span class="kw">X</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="kw">matrix</span>(<span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">2</span>,.<span class="dv">3</span>,.<span class="dv">4</span>,.<span class="dv">5</span>,.<span class="dv">6</span>,.<span class="dv">7</span>,.<span class="dv">8</span>,.<span class="dv">9</span>),<span class="dt">nrow =</span> <span class="dv">3</span>,<span class="dt">ncol =</span> <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb25-13" title="13"><span class="kw">print</span>(t)</a></code></pre></div>
<pre><code>##             [,1]         [,2]       [,3]
## [1,] -0.64543741 -1.358988893 -1.9363123
## [2,] -0.12471968  0.001991518 -0.3741590
## [3,]  0.04954611  0.059537357  0.1486383</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">cov</span>(t)</a></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]
## [1,] 0.1307529 0.2840945 0.3922588
## [2,] 0.2840945 0.6446327 0.8522836
## [3,] 0.3922588 0.8522836 1.1767764</code></pre>
<p>hw 10.11</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># 5.1</span></a>
<a class="sourceLine" id="cb29-2" title="2">n=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb29-3" title="3">m=<span class="fl">1e5</span></a>
<a class="sourceLine" id="cb29-4" title="4">t1=<span class="kw">runif</span>(n,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb29-5" title="5">t2=<span class="kw">runif</span>(m,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb29-6" title="6">theta.hat1=<span class="kw">mean</span>(<span class="kw">sin</span>(t1))<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb29-7" title="7">theta.hat2=<span class="kw">mean</span>(<span class="kw">sin</span>(t2))<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb29-8" title="8"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat1,theta.hat2,<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))))</a></code></pre></div>
<pre><code>## [1] 0.5120976 0.4993912 0.5000000</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># 5.10</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co">#Monte Carlo estimate</span></a>
<a class="sourceLine" id="cb31-3" title="3">n=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb31-4" title="4">x=<span class="kw">runif</span>(n,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-5" title="5">theta.hat=<span class="kw">mean</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb31-6" title="6">t=<span class="kw">integrate</span>(<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>),<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-7" title="7">theta.hat;t</a></code></pre></div>
<pre><code>## [1] 0.525005</code></pre>
<pre><code>## 0.5247971 with absolute error &lt; 5.8e-15</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co">#antithetic variables</span></a>
<a class="sourceLine" id="cb34-2" title="2">MC.Phi=<span class="cf">function</span>(x,<span class="dt">n=</span><span class="fl">1e4</span>,<span class="dt">antithetic=</span><span class="ot">TRUE</span>){</a>
<a class="sourceLine" id="cb34-3" title="3">  u=<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb34-4" title="4">  <span class="cf">if</span>(<span class="op">!</span>antithetic)v=<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)<span class="cf">else</span></a>
<a class="sourceLine" id="cb34-5" title="5">    v=<span class="dv">1</span><span class="op">-</span>u</a>
<a class="sourceLine" id="cb34-6" title="6">  u=<span class="kw">c</span>(u,v)</a>
<a class="sourceLine" id="cb34-7" title="7">  cdf=<span class="kw">numeric</span>(<span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb34-8" title="8">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)){</a>
<a class="sourceLine" id="cb34-9" title="9">    g=x[i]<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>u<span class="op">*</span>x[i])<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(u<span class="op">*</span>x[i])<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb34-10" title="10">    cdf[i]=<span class="kw">mean</span>(g)</a>
<a class="sourceLine" id="cb34-11" title="11">  }</a>
<a class="sourceLine" id="cb34-12" title="12">  cdf</a>
<a class="sourceLine" id="cb34-13" title="13">}</a>
<a class="sourceLine" id="cb34-14" title="14">x=<span class="dv">1</span></a>
<a class="sourceLine" id="cb34-15" title="15">theta.hat2=<span class="kw">integrate</span>(<span class="cf">function</span>(y)<span class="kw">exp</span>(<span class="op">-</span>y)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>y<span class="op">^</span><span class="dv">2</span>),<span class="dv">0</span>,x)</a>
<a class="sourceLine" id="cb34-16" title="16">Phi=theta.hat2</a>
<a class="sourceLine" id="cb34-17" title="17">MC1=MC2=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb34-18" title="18"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb34-19" title="19">MC1[i]=<span class="kw">MC.Phi</span>(x,<span class="dt">antithetic =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb34-20" title="20">MC2[i]=<span class="kw">MC.Phi</span>(x)}</a>
<a class="sourceLine" id="cb34-21" title="21"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(MC1),<span class="kw">mean</span>(MC2)))</a></code></pre></div>
<pre><code>## [1] 0.5247883 0.5247981</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">c</span>(<span class="kw">sd</span>(MC1),<span class="kw">sd</span>(MC2),(<span class="kw">sd</span>(MC1)<span class="op">-</span><span class="kw">sd</span>(MC2))<span class="op">/</span><span class="kw">sd</span>(MC1))</a></code></pre></div>
<pre><code>## [1] 0.0024626497 0.0004616826 0.8125260816</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="co"># 5.15</span></a>
<a class="sourceLine" id="cb38-2" title="2">m =<span class="dv">10000</span></a>
<a class="sourceLine" id="cb38-3" title="3">theta.hat =se =<span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb38-4" title="4">g =<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb38-5" title="5"><span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb38-6" title="6">}</a>
<a class="sourceLine" id="cb38-7" title="7">x=<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb38-8" title="8">fg=<span class="kw">g</span>(x)</a>
<a class="sourceLine" id="cb38-9" title="9">theta.hat[<span class="dv">1</span>]=<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb38-10" title="10">se[<span class="dv">1</span>]=<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb38-11" title="11">x=<span class="kw">rexp</span>(m, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb38-12" title="12">fg=<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x)</a>
<a class="sourceLine" id="cb38-13" title="13">theta.hat[<span class="dv">2</span>]=<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb38-14" title="14">se[<span class="dv">2</span>]=<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb38-15" title="15">x=<span class="kw">rcauchy</span>(m)</a>
<a class="sourceLine" id="cb38-16" title="16">i=<span class="kw">c</span>(<span class="kw">which</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>), <span class="kw">which</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb38-17" title="17">x[i]=<span class="dv">2</span> </a>
<a class="sourceLine" id="cb38-18" title="18">fg=<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dcauchy</span>(x)</a>
<a class="sourceLine" id="cb38-19" title="19">theta.hat[<span class="dv">3</span>]=<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb38-20" title="20">se[<span class="dv">3</span>]=<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb38-21" title="21">u =<span class="kw">runif</span>(m) </a>
<a class="sourceLine" id="cb38-22" title="22">x=<span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb38-23" title="23">fg=<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb38-24" title="24">theta.hat[<span class="dv">4</span>]=<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb38-25" title="25">se[<span class="dv">4</span>]=<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb38-26" title="26">u=<span class="kw">runif</span>(m) </a>
<a class="sourceLine" id="cb38-27" title="27">x=<span class="kw">tan</span>(pi <span class="op">*</span><span class="st"> </span>u <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb38-28" title="28">fg=<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>pi))</a>
<a class="sourceLine" id="cb38-29" title="29">theta.hat[<span class="dv">5</span>]=<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb38-30" title="30">se[<span class="dv">5</span>]=<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb38-31" title="31"><span class="kw">rbind</span>(theta.hat,se)</a></code></pre></div>
<pre><code>##                [,1]      [,2]      [,3]       [,4]      [,5]
## theta.hat 0.5272405 0.5236847 0.5248505 0.52259572 0.5237817
## se        0.2470013 0.4200031 0.9497976 0.09816994 0.1415871</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co">#stratified importance sampling</span></a>
<a class="sourceLine" id="cb40-2" title="2">m=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb40-3" title="3">u=<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb40-4" title="4">k=<span class="dv">5</span> </a>
<a class="sourceLine" id="cb40-5" title="5">r=m<span class="op">/</span>k</a>
<a class="sourceLine" id="cb40-6" title="6">n=<span class="dv">50</span></a>
<a class="sourceLine" id="cb40-7" title="7">t=<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb40-8" title="8">est=<span class="kw">matrix</span>(<span class="dv">0</span>, n, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-9" title="9">x=<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb40-10" title="10">g=<span class="cf">function</span>(x){<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb40-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb40-12" title="12">est[i, <span class="dv">1</span>]=<span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(m)))</a>
<a class="sourceLine" id="cb40-13" title="13"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)t[j]=<span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(m<span class="op">/</span>k,(j<span class="dv">-1</span>)<span class="op">/</span>k,j<span class="op">/</span>k)))</a>
<a class="sourceLine" id="cb40-14" title="14">est[i, <span class="dv">2</span>]=<span class="kw">mean</span>(t)</a>
<a class="sourceLine" id="cb40-15" title="15">}</a>
<a class="sourceLine" id="cb40-16" title="16"><span class="kw">apply</span>(est,<span class="dv">2</span>,mean)</a></code></pre></div>
<pre><code>## [1] 0.5245544 0.5249212</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">apply</span>(est,<span class="dv">2</span>,var)</a></code></pre></div>
<pre><code>## [1] 7.100016e-06 2.739790e-07</code></pre>
<p>hw 10.18</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co">#6.5</span></a>
<a class="sourceLine" id="cb44-2" title="2">n=<span class="dv">20</span></a>
<a class="sourceLine" id="cb44-3" title="3">alpha=.<span class="dv">05</span></a>
<a class="sourceLine" id="cb44-4" title="4">theta.hat1=<span class="kw">replicate</span>(<span class="dv">10000</span>,<span class="dt">expr =</span>{</a>
<a class="sourceLine" id="cb44-5" title="5">  x=<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb44-6" title="6">  y=<span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb44-7" title="7">  sigma=<span class="kw">var</span>(x)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb44-8" title="8">  theta.hat=<span class="kw">mean</span>(x)<span class="op">-</span>(y<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>sigma<span class="op">*</span><span class="kw">qt</span>(alpha,<span class="dt">df=</span><span class="dv">40</span>))<span class="op">/</span>(<span class="dv">800</span><span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb44-9" title="9">})</a>
<a class="sourceLine" id="cb44-10" title="10"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(theta.hat1<span class="op">&gt;=</span><span class="dv">2</span>)),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.8564</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">theta.hat2=<span class="kw">replicate</span>(<span class="dv">10000</span>,<span class="dt">expr =</span>{</a>
<a class="sourceLine" id="cb46-2" title="2">  x=<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb46-3" title="3">  s=<span class="kw">var</span>(x)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb46-4" title="4">  xbat=<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb46-5" title="5">  xbat<span class="op">+</span><span class="kw">abs</span>((s<span class="op">*</span><span class="kw">qt</span>(alpha,<span class="dt">df=</span>n<span class="dv">-1</span>))<span class="op">/</span>n<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb46-6" title="6">})</a>
<a class="sourceLine" id="cb46-7" title="7"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(theta.hat2<span class="op">&gt;=</span><span class="dv">2</span>)),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.8959</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">ucl=<span class="kw">replicate</span>(<span class="dv">10000</span>,<span class="dt">expr =</span>{</a>
<a class="sourceLine" id="cb48-2" title="2">  x=<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb48-3" title="3">  (n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(alpha,<span class="dt">df=</span>n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb48-4" title="4">})</a>
<a class="sourceLine" id="cb48-5" title="5"><span class="kw">mean</span>(ucl<span class="op">&gt;</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.7855</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co"># 6.6</span></a>
<a class="sourceLine" id="cb50-2" title="2">m=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb50-3" title="3">n=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb50-4" title="4">p=<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb50-5" title="5"><span class="co">#skewness under normality</span></a>
<a class="sourceLine" id="cb50-6" title="6">ske=<span class="cf">function</span>(x){ </a>
<a class="sourceLine" id="cb50-7" title="7">  x=<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb50-8" title="8">  x.bat=<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb50-9" title="9">  m1=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb50-10" title="10">  m2=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb50-11" title="11">  <span class="kw">return</span> (m1<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb50-12" title="12">}</a>
<a class="sourceLine" id="cb50-13" title="13">k=<span class="kw">replicate</span>(m,<span class="kw">ske</span>(x))</a>
<a class="sourceLine" id="cb50-14" title="14">c1=<span class="kw">quantile</span>(k,p)</a>
<a class="sourceLine" id="cb50-15" title="15">c1</a></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1555440 -0.1302190  0.1258893  0.1503120</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">z=(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))<span class="op">/</span>(n<span class="op">*</span><span class="kw">dnorm</span>(c1,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">sqrt</span>(z)</a></code></pre></div>
<pre><code>##        2.5%          5%         95%       97.5% 
## 0.007198554 0.005498023 0.005012737 0.006299865</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">ske.hat=<span class="kw">rnorm</span>(m,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb54-2" title="2">c2=<span class="kw">quantile</span>(ske.hat,p)</a>
<a class="sourceLine" id="cb54-3" title="3">c2</a></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1512602 -0.1269320  0.1254053  0.1479739</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">c3=<span class="kw">qnorm</span>(p,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb56-2" title="2">c=<span class="kw">data.frame</span>(c1,c2,c3,z)</a>
<a class="sourceLine" id="cb56-3" title="3">c</a></code></pre></div>
<pre><code>##               c1         c2         c3            z
## 2.5%  -0.1555440 -0.1512602 -0.1518182 5.181918e-05
## 5%    -0.1302190 -0.1269320 -0.1274098 3.022826e-05
## 95%    0.1258893  0.1254053  0.1274098 2.512753e-05
## 97.5%  0.1503120  0.1479739  0.1518182 3.968830e-05</code></pre>
<p>hw 11.01</p>
<p>6.7:use R to compute the rejected proportion,because of the proportion too small,the power is not robust.but when sample from t(v),we can said the power better.in the first figure,we know when ε=0.8，the power is greatest.in tne next figure,we know the ε smaller,the power greater. 6.A:we know when the sample population is non-normality,compare the results,the sample form uniform distribution have a rate which close to the nominal rate(0.05).</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># 6.7</span></a>
<a class="sourceLine" id="cb58-2" title="2">alpha=<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb58-3" title="3">n=<span class="dv">20</span></a>
<a class="sourceLine" id="cb58-4" title="4">m=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb58-5" title="5">d=<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.01</span>),<span class="kw">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb58-6" title="6">N=<span class="kw">length</span>(d)</a>
<a class="sourceLine" id="cb58-7" title="7">pwr=pwr1=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb58-8" title="8">cv=<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb58-9" title="9">sk=<span class="cf">function</span>(x){ </a>
<a class="sourceLine" id="cb58-10" title="10">  x.bat=<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb58-11" title="11">  m1=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb58-12" title="12">  m2=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb58-13" title="13">  <span class="kw">return</span> (m1<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb58-14" title="14">}</a>
<a class="sourceLine" id="cb58-15" title="15"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb58-16" title="16">  e=d[j]</a>
<a class="sourceLine" id="cb58-17" title="17">  sktests=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb58-18" title="18">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb58-19" title="19">  sigma=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>),<span class="dt">replace =</span> <span class="ot">TRUE</span>,n,<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e,e))</a>
<a class="sourceLine" id="cb58-20" title="20">  x=<span class="kw">rbeta</span>(n,sigma,sigma)</a>
<a class="sourceLine" id="cb58-21" title="21">  sktests[i]=<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span>cv)</a>
<a class="sourceLine" id="cb58-22" title="22">  }</a>
<a class="sourceLine" id="cb58-23" title="23"> pwr[j]=<span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb58-24" title="24">}</a>
<a class="sourceLine" id="cb58-25" title="25"><span class="kw">mean</span>(pwr)</a></code></pre></div>
<pre><code>## [1] 0.1305441</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb60-2" title="2">  e=d[j]</a>
<a class="sourceLine" id="cb60-3" title="3">  sktests=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb60-4" title="4">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb60-5" title="5">  sigma=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">replace =</span> <span class="ot">TRUE</span>,n,<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e,e))</a>
<a class="sourceLine" id="cb60-6" title="6">  x=<span class="kw">rt</span>(n,<span class="dt">df=</span>sigma)</a>
<a class="sourceLine" id="cb60-7" title="7">  sktests[i]=<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span>cv)</a>
<a class="sourceLine" id="cb60-8" title="8">  }</a>
<a class="sourceLine" id="cb60-9" title="9">  pwr1[j]=<span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb60-10" title="10">}</a>
<a class="sourceLine" id="cb60-11" title="11"><span class="kw">mean</span>(pwr1)</a></code></pre></div>
<pre><code>## [1] 0.6767088</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">plot</span>(d,pwr,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(d),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">pch=</span><span class="st">&quot;￥&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red3&quot;</span>)</a>
<a class="sourceLine" id="cb62-3" title="3">se=<span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb62-4" title="4"><span class="kw">lines</span>(d,pwr<span class="op">+</span>se,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">lwd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb62-5" title="5"><span class="kw">lines</span>(d,pwr<span class="op">-</span>se,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lwd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb62-6" title="6"><span class="kw">plot</span>(d,pwr1,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(d),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">pch=</span><span class="st">&quot;￥&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red3&quot;</span>)</a>
<a class="sourceLine" id="cb62-7" title="7">se1=<span class="kw">sqrt</span>(pwr1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr1)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb62-8" title="8"><span class="kw">lines</span>(d,pwr1<span class="op">+</span>se1,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">lwd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb62-9" title="9"><span class="kw">lines</span>(d,pwr1<span class="op">-</span>se1,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lwd=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># 6.A</span></a>
<a class="sourceLine" id="cb63-2" title="2">alpha=<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb63-3" title="3">mu0=<span class="dv">1</span></a>
<a class="sourceLine" id="cb63-4" title="4">n=<span class="dv">20</span></a>
<a class="sourceLine" id="cb63-5" title="5">m=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb63-6" title="6">p1=p2=p3=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb63-7" title="7"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb63-8" title="8">  x=<span class="kw">rchisq</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb63-9" title="9">  y=<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb63-10" title="10">  z=<span class="kw">rexp</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb63-11" title="11">  t1=<span class="kw">t.test</span>(x,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb63-12" title="12">  t2=<span class="kw">t.test</span>(y,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb63-13" title="13">  t3=<span class="kw">t.test</span>(z,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb63-14" title="14">  p1[j]=t1<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb63-15" title="15">  p2[j]=t2<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb63-16" title="16">  p3[j]=t3<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb63-17" title="17">}</a>
<a class="sourceLine" id="cb63-18" title="18">p.hat=<span class="kw">c</span>(<span class="kw">mean</span>(p1<span class="op">&lt;</span>alpha),<span class="kw">mean</span>(p2<span class="op">&lt;</span>alpha),<span class="kw">mean</span>(p3<span class="op">&lt;</span>alpha))</a>
<a class="sourceLine" id="cb63-19" title="19">se.hat=<span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb63-20" title="20"><span class="kw">data.frame</span>(p.hat,se.hat,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;(i)χ2(1)&quot;</span>,<span class="st">&quot;(ii)Uniform(0,2)&quot;</span>,<span class="st">&quot;(iii)Exponential(1)&quot;</span>))</a></code></pre></div>
<pre><code>##                      p.hat      se.hat
## (i)χ2(1)            0.0118 0.001079850
## (ii)Uniform(0,2)    0.0472 0.002120664
## (iii)Exponential(1) 0.0202 0.001406839</code></pre>
<p>hw 11.08 7.6:use R to analyze the question.in the plots figures,we know all subjects have positive correlation property.look at the sparseness of the plots,we can find their correlation size.compute the s.e,all errors are small. 7.B:compare the result of normal distribution and chisq distribution,the coverage rate of normal distribution is larger.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co"># 7.6</span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb65-3" title="3"><span class="kw">pairs</span>(scor[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],<span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">COR=<span class="kw">cor</span>(scor)</a>
<a class="sourceLine" id="cb66-2" title="2">COR</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">N=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb68-2" title="2">n=<span class="dv">88</span></a>
<a class="sourceLine" id="cb68-3" title="3">r1=r2=r3=r4=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb68-4" title="4"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb68-5" title="5">  i=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb68-6" title="6">  x1=scor<span class="op">$</span>mec[i]</a>
<a class="sourceLine" id="cb68-7" title="7">  x2=scor<span class="op">$</span>vec[i]</a>
<a class="sourceLine" id="cb68-8" title="8">  x3=scor<span class="op">$</span>alg[i]</a>
<a class="sourceLine" id="cb68-9" title="9">  x4=scor<span class="op">$</span>ana[i]</a>
<a class="sourceLine" id="cb68-10" title="10">  x5=scor<span class="op">$</span>sta[i]</a>
<a class="sourceLine" id="cb68-11" title="11">  r1[j]=<span class="kw">cor</span>(x1,x2)</a>
<a class="sourceLine" id="cb68-12" title="12">  r2[j]=<span class="kw">cor</span>(x3,x4)</a>
<a class="sourceLine" id="cb68-13" title="13">  r3[j]=<span class="kw">cor</span>(x3,x5)</a>
<a class="sourceLine" id="cb68-14" title="14">  r4[j]=<span class="kw">cor</span>(x4,x5)</a>
<a class="sourceLine" id="cb68-15" title="15">}</a>
<a class="sourceLine" id="cb68-16" title="16">s.e=<span class="kw">c</span>(<span class="dt">se.r1=</span><span class="kw">sd</span>(r1),<span class="dt">se.r2=</span><span class="kw">sd</span>(r2),<span class="dt">se.r3=</span><span class="kw">sd</span>(r3),<span class="dt">se.r4=</span><span class="kw">sd</span>(r4))</a>
<a class="sourceLine" id="cb68-17" title="17"><span class="kw">print</span>(s.e,<span class="dv">4</span>)</a></code></pre></div>
<pre><code>##   se.r1   se.r2   se.r3   se.r4 
## 0.07611 0.04866 0.05983 0.06745</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co"># 7.B</span></a>
<a class="sourceLine" id="cb70-2" title="2">m=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb70-3" title="3">n=<span class="dv">100</span></a>
<a class="sourceLine" id="cb70-4" title="4">mu=<span class="dv">0</span></a>
<a class="sourceLine" id="cb70-5" title="5">t=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb70-6" title="6"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb70-7" title="7"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb70-8" title="8">ci.norm=ci.basic=ci.perc=<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-9" title="9">sk=<span class="cf">function</span>(x){ </a>
<a class="sourceLine" id="cb70-10" title="10">  x.bat=<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb70-11" title="11">  m1=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb70-12" title="12">  m2=<span class="kw">mean</span>((x<span class="op">-</span>x.bat)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-13" title="13">  <span class="kw">return</span> (m1<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb70-14" title="14">}</a>
<a class="sourceLine" id="cb70-15" title="15">boot.median=<span class="cf">function</span>(x,j) <span class="kw">mean</span>(<span class="kw">sk</span>(x[j]))</a>
<a class="sourceLine" id="cb70-16" title="16"><span class="co"># normal populations</span></a>
<a class="sourceLine" id="cb70-17" title="17"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb70-18" title="18"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb70-19" title="19">  x=<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb70-20" title="20">  t[j]=<span class="kw">sk</span>(x)</a>
<a class="sourceLine" id="cb70-21" title="21">}  </a>
<a class="sourceLine" id="cb70-22" title="22">  de=<span class="kw">boot</span>(<span class="dt">data=</span>t,<span class="dt">statistic=</span>boot.median,<span class="dt">R=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb70-23" title="23">  ci=<span class="kw">boot.ci</span>(de,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</a>
<a class="sourceLine" id="cb70-24" title="24">  ci.norm[i,]=ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb70-25" title="25">  ci.basic[i,]=ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb70-26" title="26">  ci.perc[i,]=ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb70-27" title="27">}</a>
<a class="sourceLine" id="cb70-28" title="28">p1.norm=<span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu<span class="op">&amp;</span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span>mu),<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span>mu))</a>
<a class="sourceLine" id="cb70-29" title="29">p1.basic=<span class="kw">c</span>(<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu<span class="op">&amp;</span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span>mu),<span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span>mu))</a>
<a class="sourceLine" id="cb70-30" title="30">p1.perc=<span class="kw">c</span>(<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu<span class="op">&amp;</span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span>mu),<span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span>mu))</a>
<a class="sourceLine" id="cb70-31" title="31"><span class="kw">data.frame</span>(p1.norm,p1.basic,p1.perc,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;on the left&quot;</span>,<span class="st">&quot;on the right&quot;</span>))</a></code></pre></div>
<pre><code>##              p1.norm p1.basic p1.perc
## coverage       0.902    0.897   0.932
## on the left    0.052    0.055   0.041
## on the right   0.046    0.048   0.027</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co"># χ2(5) distributions</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="kw">library</span>(moments)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;moments&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:e1071&#39;:
## 
##     kurtosis, moment, skewness</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">mu1=(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb75-2" title="2">t=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb75-3" title="3"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb75-4" title="4"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb75-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb75-6" title="6"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb75-7" title="7">  x=<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb75-8" title="8">  t[j]=<span class="kw">sk</span>(x)</a>
<a class="sourceLine" id="cb75-9" title="9">}  </a>
<a class="sourceLine" id="cb75-10" title="10">  de=<span class="kw">boot</span>(<span class="dt">data=</span>t,<span class="dt">statistic=</span>boot.median,<span class="dt">R=</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb75-11" title="11">  ci=<span class="kw">boot.ci</span>(de,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</a>
<a class="sourceLine" id="cb75-12" title="12">  ci.norm[i,]=ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb75-13" title="13">  ci.basic[i,]=ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb75-14" title="14">  ci.perc[i,]=ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb75-15" title="15">}</a>
<a class="sourceLine" id="cb75-16" title="16">p2.norm=<span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1<span class="op">&amp;</span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1),<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span>mu1),<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span>mu1))</a>
<a class="sourceLine" id="cb75-17" title="17">p2.basic=<span class="kw">c</span>(<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1<span class="op">&amp;</span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1),<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span>mu1),<span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span>mu1))</a>
<a class="sourceLine" id="cb75-18" title="18">p2.perc=<span class="kw">c</span>(<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1<span class="op">&amp;</span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1),<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span>mu1),<span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span>mu1))</a>
<a class="sourceLine" id="cb75-19" title="19"><span class="kw">data.frame</span>(p2.norm,p2.basic,p2.perc,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;on the left&quot;</span>,<span class="st">&quot;on the right&quot;</span>))</a></code></pre></div>
<pre><code>##              p2.norm p2.basic p2.perc
## coverage       0.624    0.594   0.590
## on the left    0.026    0.063   0.002
## on the right   0.350    0.343   0.408</code></pre>
<p>hw 11.16 look at the result,we know when the model is quadratic,the error is least0.05452,the model is Y=24.49262-1.39334X+0.05707<span class="math inline">\(X^{2}\)</span>；when the is quadratic,the <span class="math inline">\(R^{2}\)</span> is largest,too.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># 7.8</span></a>
<a class="sourceLine" id="cb77-2" title="2">n=<span class="dv">5</span>;m=<span class="dv">88</span></a>
<a class="sourceLine" id="cb77-3" title="3"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb77-4" title="4">COV<span class="fl">.0</span>=<span class="kw">cov</span>(scor)</a>
<a class="sourceLine" id="cb77-5" title="5">COV=(<span class="dv">87</span><span class="op">/</span><span class="dv">88</span>)<span class="op">*</span>COV<span class="fl">.0</span></a>
<a class="sourceLine" id="cb77-6" title="6">eigen=<span class="kw">c</span>(<span class="kw">eigen</span>(COV,<span class="dt">only.values=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb77-7" title="7">e=<span class="kw">c</span>(eigen<span class="op">$</span>values[<span class="dv">1</span><span class="op">:</span><span class="dv">1</span>],eigen<span class="op">$</span>values[<span class="dv">2</span><span class="op">:</span><span class="dv">2</span>],eigen<span class="op">$</span>values[<span class="dv">3</span><span class="op">:</span><span class="dv">3</span>],eigen<span class="op">$</span>values[<span class="dv">4</span><span class="op">:</span><span class="dv">4</span>],eigen<span class="op">$</span>values[<span class="dv">5</span><span class="op">:</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb77-8" title="8">theta.hat=<span class="kw">max</span>(e)<span class="op">/</span><span class="kw">sum</span>(e)</a>
<a class="sourceLine" id="cb77-9" title="9">theta.jack=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb77-10" title="10">e.hat=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb77-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb77-12" title="12"> COV.hat0=<span class="kw">cov</span>(scor[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb77-13" title="13"> COV.hat=(<span class="dv">87</span><span class="op">/</span><span class="dv">88</span>)<span class="op">*</span>COV.hat0</a>
<a class="sourceLine" id="cb77-14" title="14"> eigen.hat=<span class="kw">eigen</span>(COV.hat)</a>
<a class="sourceLine" id="cb77-15" title="15"> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb77-16" title="16">   e.hat[j]=eigen.hat<span class="op">$</span>values[j<span class="op">:</span>j]</a>
<a class="sourceLine" id="cb77-17" title="17"> }</a>
<a class="sourceLine" id="cb77-18" title="18"> theta.jack[i]=<span class="kw">max</span>(e.hat)<span class="op">/</span><span class="kw">sum</span>(e.hat)</a>
<a class="sourceLine" id="cb77-19" title="19">}</a>
<a class="sourceLine" id="cb77-20" title="20">bias.jack=(m<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</a>
<a class="sourceLine" id="cb77-21" title="21">se.jack=<span class="kw">sqrt</span>((m<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb77-22" title="22">bias.jack;se.jack</a></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<pre><code>## [1] 0.04955244</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co"># 7.10</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># estimate</span></a>
<a class="sourceLine" id="cb84-2" title="2">a=<span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb84-3" title="3"><span class="co">## linear</span></a>
<a class="sourceLine" id="cb84-4" title="4">J10=<span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb84-5" title="5">yhat10=J10<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J10<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span>a</a>
<a class="sourceLine" id="cb84-6" title="6">R10=<span class="kw">summary</span>(J10)</a>
<a class="sourceLine" id="cb84-7" title="7"><span class="co">## quadratic</span></a>
<a class="sourceLine" id="cb84-8" title="8">J20=<span class="kw">lm</span>(magnetic<span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb84-9" title="9">yhat20=J20<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J20<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">+</span></a>
<a class="sourceLine" id="cb84-10" title="10">J20<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb84-11" title="11">R20=<span class="kw">summary</span>(J20)</a>
<a class="sourceLine" id="cb84-12" title="12"><span class="co">## exponential</span></a>
<a class="sourceLine" id="cb84-13" title="13">J30=<span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb84-14" title="14">logyhat30=J30<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J30<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb84-15" title="15">R30=<span class="kw">summary</span>(J30)</a>
<a class="sourceLine" id="cb84-16" title="16"><span class="co">## log-log</span></a>
<a class="sourceLine" id="cb84-17" title="17">J40=<span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(chemical))</a>
<a class="sourceLine" id="cb84-18" title="18">logyhat40=J40<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J40<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(a)</a>
<a class="sourceLine" id="cb84-19" title="19">R40=<span class="kw">summary</span>(J40)</a>
<a class="sourceLine" id="cb84-20" title="20"><span class="co">## cubic</span></a>
<a class="sourceLine" id="cb84-21" title="21">J50=<span class="kw">lm</span>(magnetic<span class="op">~</span>chemical<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb84-22" title="22">yhat5=J50<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J50<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">+</span>J50<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span><span class="op">+</span>J50<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb84-23" title="23">R50=<span class="kw">summary</span>(J50)</a>
<a class="sourceLine" id="cb84-24" title="24">R1=<span class="kw">summary</span>(J10);R2=<span class="kw">summary</span>(J20);R3=<span class="kw">summary</span>(J30);R4=<span class="kw">summary</span>(J40);R5=<span class="kw">summary</span>(J50)</a>
<a class="sourceLine" id="cb84-25" title="25">R.squard=<span class="kw">c</span>(R1<span class="op">$</span>adj.r.squared,R2<span class="op">$</span>adj.r.squared,R3<span class="op">$</span>adj.r.squared,R4<span class="op">$</span>adj.r.squared,R5<span class="op">$</span>adj.r.squared)</a>
<a class="sourceLine" id="cb84-26" title="26"><span class="co"># compute the error</span></a>
<a class="sourceLine" id="cb84-27" title="27">n =<span class="kw">length</span>(magnetic)</a>
<a class="sourceLine" id="cb84-28" title="28">e1=e2=e3=e4=e5=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb84-29" title="29"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb84-30" title="30">y=magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb84-31" title="31">x=chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb84-32" title="32"><span class="co">## linear</span></a>
<a class="sourceLine" id="cb84-33" title="33">J1=<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb84-34" title="34">yhat1=J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb84-35" title="35">e1[k]=magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb84-36" title="36"></a>
<a class="sourceLine" id="cb84-37" title="37"><span class="co">## quadratic</span></a>
<a class="sourceLine" id="cb84-38" title="38">J2=<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb84-39" title="39">yhat2=J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb84-40" title="40">J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb84-41" title="41">e2[k]=magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb84-42" title="42"></a>
<a class="sourceLine" id="cb84-43" title="43"><span class="co">## exponential</span></a>
<a class="sourceLine" id="cb84-44" title="44">J3=<span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb84-45" title="45">logyhat3=J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb84-46" title="46">yhat3=<span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb84-47" title="47">e3[k]=magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb84-48" title="48"></a>
<a class="sourceLine" id="cb84-49" title="49"><span class="co">## log-log</span></a>
<a class="sourceLine" id="cb84-50" title="50">J4=<span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb84-51" title="51">logyhat4=J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</a>
<a class="sourceLine" id="cb84-52" title="52">yhat4=<span class="kw">exp</span>(logyhat4)</a>
<a class="sourceLine" id="cb84-53" title="53">e4[k]=magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb84-54" title="54"></a>
<a class="sourceLine" id="cb84-55" title="55"><span class="co">## cubic</span></a>
<a class="sourceLine" id="cb84-56" title="56">J5=<span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb84-57" title="57">yhat5=J5<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J5<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">+</span>J5<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span><span class="op">+</span>J5<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb84-58" title="58">e5[k]=magnetic[k]<span class="op">-</span>yhat5</a>
<a class="sourceLine" id="cb84-59" title="59"></a>
<a class="sourceLine" id="cb84-60" title="60">}</a>
<a class="sourceLine" id="cb84-61" title="61">error=<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e5<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb84-62" title="62">R.squard=<span class="kw">c</span>(R1<span class="op">$</span>adj.r.squared,R2<span class="op">$</span>adj.r.squared,R3<span class="op">$</span>adj.r.squared,R4<span class="op">$</span>adj.r.squared,R5<span class="op">$</span>adj.r.squared)</a>
<a class="sourceLine" id="cb84-63" title="63"><span class="kw">data.frame</span>(error,R.squard,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;linear&quot;</span>,<span class="st">&quot;quadratic&quot;</span>,<span class="st">&quot;exponential&quot;</span>,<span class="st">&quot;log-log&quot;</span>,<span class="st">&quot;cubic&quot;</span>))</a></code></pre></div>
<pre><code>##                error  R.squard
## linear      19.55644 0.5281545
## quadratic   17.85248 0.5768151
## exponential 18.44188 0.5280556
## log-log     20.45424 0.4870624
## cubic       18.17756 0.5740396</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">J20</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>hw 11.22 8.3:use R to compute the power.when the sample sizes are not equal,the power is smaller than the power which use the permutation test. page31:look at the figures,we know when n is larger,the power larger,and the distance correlation test ia better.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co"># 8.3</span></a>
<a class="sourceLine" id="cb88-2" title="2">n=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb88-3" title="3">K=<span class="dv">1</span><span class="op">:</span><span class="dv">50</span></a>
<a class="sourceLine" id="cb88-4" title="4">m=<span class="dv">20</span></a>
<a class="sourceLine" id="cb88-5" title="5">power=x=y=z=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb88-6" title="6"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb88-7" title="7"><span class="co"># bulid a function</span></a>
<a class="sourceLine" id="cb88-8" title="8">count5test=<span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb88-9" title="9">X=x<span class="op">-</span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb88-10" title="10">Y=x<span class="op">-</span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb88-11" title="11">outx=<span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb88-12" title="12">outy=<span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb88-13" title="13"><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb88-14" title="14">}</a>
<a class="sourceLine" id="cb88-15" title="15"><span class="co"># permutation test method</span></a>
<a class="sourceLine" id="cb88-16" title="16">p=<span class="kw">replicate</span>(n,<span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb88-17" title="17">  x=<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb88-18" title="18">  y=<span class="kw">rnorm</span>(<span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb88-19" title="19">  x=x<span class="op">-</span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb88-20" title="20">  y=y<span class="op">-</span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb88-21" title="21">  z=<span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb88-22" title="22"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb88-23" title="23">  k=<span class="kw">sample</span>(K,m,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb88-24" title="24">  x1=z[k]</a>
<a class="sourceLine" id="cb88-25" title="25">  y1=z[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb88-26" title="26">  power[i]=<span class="kw">count5test</span>(x1,y1)</a>
<a class="sourceLine" id="cb88-27" title="27">}</a>
<a class="sourceLine" id="cb88-28" title="28">  <span class="kw">mean</span>(power)</a>
<a class="sourceLine" id="cb88-29" title="29">  })</a>
<a class="sourceLine" id="cb88-30" title="30">p1=<span class="kw">mean</span>(p)</a>
<a class="sourceLine" id="cb88-31" title="31">p1</a></code></pre></div>
<pre><code>## [1] 0.020361</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co"># page 31</span></a>
<a class="sourceLine" id="cb90-2" title="2">dCov=<span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb90-3" title="3">x=<span class="kw">as.matrix</span>(x); y=<span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb90-4" title="4">n=<span class="kw">nrow</span>(x); m=<span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb90-5" title="5"><span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb90-6" title="6"><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb90-7" title="7"><span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb90-8" title="8">Akl=<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb90-9" title="9">d=<span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb90-10" title="10">m=<span class="kw">rowMeans</span>(d); M=<span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb90-11" title="11">a=<span class="kw">sweep</span>(d, <span class="dv">1</span>, m); b=<span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb90-12" title="12">b <span class="op">+</span><span class="st"> </span>M</a>
<a class="sourceLine" id="cb90-13" title="13">}</a>
<a class="sourceLine" id="cb90-14" title="14">A=<span class="kw">Akl</span>(x); B=<span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb90-15" title="15"><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb90-16" title="16">}</a>
<a class="sourceLine" id="cb90-17" title="17">ndCov2=<span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb90-18" title="18"><span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb90-19" title="19">p=dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb90-20" title="20">q=dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb90-21" title="21">d=p <span class="op">+</span><span class="st"> </span>q</a>
<a class="sourceLine" id="cb90-22" title="22">x=z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb90-23" title="23">y=z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb90-24" title="24"><span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb90-25" title="25">}</a>
<a class="sourceLine" id="cb90-26" title="26"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb90-27" title="27"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb90-28" title="28"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb93-2" title="2">m=<span class="dv">10</span></a>
<a class="sourceLine" id="cb93-3" title="3">sigma=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-4" title="4">p.cor=p.ball=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb93-5" title="5"><span class="co"># model 1</span></a>
<a class="sourceLine" id="cb93-6" title="6">p=<span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb93-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb93-8" title="8">x=<span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</a>
<a class="sourceLine" id="cb93-9" title="9">e=<span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</a>
<a class="sourceLine" id="cb93-10" title="10">y=(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>x<span class="op">+</span>e</a>
<a class="sourceLine" id="cb93-11" title="11">z=<span class="kw">cbind</span>(x,y)</a>
<a class="sourceLine" id="cb93-12" title="12">boot.obj=<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">99</span>,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb93-13" title="13">tb =<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb93-14" title="14">p.cor[i] =<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb93-15" title="15">p.ball[i] =<span class="st"> </span><span class="kw">bcov.test</span>(z[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],z[,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">R=</span><span class="dv">99</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb93-16" title="16">}</a>
<a class="sourceLine" id="cb93-17" title="17"><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(p.cor),<span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(p.ball))}</a>
<a class="sourceLine" id="cb93-18" title="18">t=<span class="kw">rbind</span>(<span class="kw">p</span>(<span class="dv">5</span>),<span class="kw">p</span>(<span class="dv">10</span>),<span class="kw">p</span>(<span class="dv">20</span>),<span class="kw">p</span>(<span class="dv">30</span>),<span class="kw">p</span>(<span class="dv">40</span>),<span class="kw">p</span>(<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb93-19" title="19"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">10</span>)),t[,<span class="dv">1</span>],<span class="st">&#39;l&#39;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&#39;n&#39;</span>,<span class="dt">main =</span> <span class="st">&#39;model 1&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;power&#39;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb93-20" title="20"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">10</span>)),t[,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb93-21" title="21"><span class="kw">legend</span>(<span class="dv">35</span>,<span class="fl">0.4</span>,<span class="kw">c</span>(<span class="st">&#39;p.cor&#39;</span>,<span class="st">&#39;p.ball&#39;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb93-22" title="22">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>),<span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="co"># model 2</span></a>
<a class="sourceLine" id="cb94-2" title="2">f=<span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb94-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb94-4" title="4">x=<span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</a>
<a class="sourceLine" id="cb94-5" title="5">e=<span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</a>
<a class="sourceLine" id="cb94-6" title="6">y=(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>x<span class="op">*</span>e</a>
<a class="sourceLine" id="cb94-7" title="7">z=<span class="kw">cbind</span>(x,y)</a>
<a class="sourceLine" id="cb94-8" title="8">boot.obj=<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">99</span>,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb94-9" title="9">tb =<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb94-10" title="10">p.cor[i] =<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb94-11" title="11">p.ball[i] =<span class="st"> </span><span class="kw">bcov.test</span>(z[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],z[,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">R=</span><span class="dv">99</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb94-12" title="12">}</a>
<a class="sourceLine" id="cb94-13" title="13"><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(p.cor),<span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(p.ball))}</a>
<a class="sourceLine" id="cb94-14" title="14">t=<span class="kw">rbind</span>(<span class="kw">f</span>(<span class="dv">5</span>),<span class="kw">f</span>(<span class="dv">10</span>),<span class="kw">f</span>(<span class="dv">20</span>),<span class="kw">f</span>(<span class="dv">30</span>),<span class="kw">f</span>(<span class="dv">40</span>),<span class="kw">f</span>(<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb94-15" title="15"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">10</span>)),t[,<span class="dv">1</span>],<span class="st">&#39;l&#39;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&#39;n&#39;</span>,<span class="dt">main =</span> <span class="st">&#39;model 2&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;power&#39;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb94-16" title="16"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">10</span>)),t[,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb94-17" title="17"><span class="kw">legend</span>(<span class="dv">35</span>,<span class="fl">0.4</span>,<span class="kw">c</span>(<span class="st">&#39;p.cor&#39;</span>,<span class="st">&#39;p.ball&#39;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb94-18" title="18">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>),<span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>hw 11.29 9.4:use R to generate the chain,when sigma are different,look at the plots,when know when sigma is 1,the chain is mixing well.(the rate is not small and coverage is fast)</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">N=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb95-2" title="2">df=<span class="cf">function</span>(x)(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb95-3" title="3">rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb95-4" title="4">x=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb95-5" title="5">x[<span class="dv">1</span>] =<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb95-6" title="6">u=<span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb95-7" title="7">k =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb95-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb95-9" title="9">y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb95-10" title="10"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">df</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">df</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb95-11" title="11">x[i] =<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb95-12" title="12">x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb95-13" title="13">k =<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb95-14" title="14">}</a>
<a class="sourceLine" id="cb95-15" title="15">}</a>
<a class="sourceLine" id="cb95-16" title="16"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb95-17" title="17">}</a>
<a class="sourceLine" id="cb95-18" title="18"><span class="co"># generated for different variances σ2 of the proposal distribution</span></a>
<a class="sourceLine" id="cb95-19" title="19">sigma=<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb95-20" title="20">m=<span class="dv">4</span>;p=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb95-21" title="21">x0=<span class="dv">10</span></a>
<a class="sourceLine" id="cb95-22" title="22">rw1 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb95-23" title="23">rw2 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb95-24" title="24">rw3 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb95-25" title="25">rw4 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb95-26" title="26">rw=<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb95-27" title="27"><span class="co"># rates</span></a>
<a class="sourceLine" id="cb95-28" title="28"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb95-29" title="29">        p[i]=rw[i]<span class="op">/</span>N</a>
<a class="sourceLine" id="cb95-30" title="30">}</a>
<a class="sourceLine" id="cb95-31" title="31">q=<span class="dv">1</span><span class="op">-</span>p</a>
<a class="sourceLine" id="cb95-32" title="32"> rw</a></code></pre></div>
<pre><code>## [1]  15 173 299 851</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"> p</a></code></pre></div>
<pre><code>## [1] 0.015 0.173 0.299 0.851</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"> q</a></code></pre></div>
<pre><code>## [1] 0.985 0.827 0.701 0.149</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"> <span class="co"># plots</span></a>
<a class="sourceLine" id="cb101-2" title="2"> index=<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb101-3" title="3"> y1=rw1<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb101-4" title="4"> <span class="kw">plot</span>(index, y1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=0.05&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"> y2=rw2<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb102-2" title="2"> <span class="kw">plot</span>(index, y2, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=0.5&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"> y3=rw3<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb103-2" title="2"> <span class="kw">plot</span>(index, y3, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"> y4=rw4<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb104-2" title="2"> <span class="kw">plot</span>(index, y4, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sigma=10&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> hw12.06 11.1:use R to compute the logarithm and exponential functions when x=10.compare the values,we find that the result does not hold exactly in computer arithmetic but near equality. use R to compute the roots.compare with 11.4,we know the results are approximate.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co"># 11.1</span></a>
<a class="sourceLine" id="cb105-2" title="2">x=<span class="dv">10</span></a>
<a class="sourceLine" id="cb105-3" title="3">f=<span class="cf">function</span>(x)<span class="kw">log</span>(<span class="kw">exp</span>(x))</a>
<a class="sourceLine" id="cb105-4" title="4">g=<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb105-5" title="5"><span class="kw">print</span>(<span class="kw">f</span>(x)<span class="op">-</span><span class="kw">g</span>(x))</a></code></pre></div>
<pre><code>## [1] -1.776357e-15</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="co"># compare f and g</span></a>
<a class="sourceLine" id="cb107-2" title="2"><span class="kw">f</span>(x)<span class="op">-</span><span class="kw">g</span>(x)<span class="op">==</span><span class="dv">0</span></a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="co"># nearly equal</span></a>
<a class="sourceLine" id="cb109-2" title="2"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">f</span>(x),<span class="kw">g</span>(x)))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="co"># 11.4</span></a>
<a class="sourceLine" id="cb111-2" title="2">c.k=<span class="cf">function</span>(k,a){<span class="kw">return</span>(<span class="kw">sqrt</span>((k<span class="op">*</span>(a<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))}</a>
<a class="sourceLine" id="cb111-3" title="3">f1=<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>(u<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb111-4" title="4">f2=<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>(u<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb111-5" title="5">f=<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb111-6" title="6">(<span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">*</span><span class="kw">gamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f1,<span class="dv">0</span>,<span class="kw">c.k</span>(k<span class="dv">-1</span>,a))<span class="op">$</span>value<span class="dv">-2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f2,<span class="dv">0</span>,<span class="kw">c.k</span>(k,a))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb111-7" title="7">}  </a>
<a class="sourceLine" id="cb111-8" title="8"><span class="co"># compute roots</span></a>
<a class="sourceLine" id="cb111-9" title="9"><span class="kw">library</span>(rootSolve)</a>
<a class="sourceLine" id="cb111-10" title="10">t=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb111-11" title="11">n=<span class="kw">length</span>(t)</a>
<a class="sourceLine" id="cb111-12" title="12">root=root2=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb111-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb111-14" title="14">  k=t[i]</a>
<a class="sourceLine" id="cb111-15" title="15">  root[i]=<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb111-16" title="16">}</a>
<a class="sourceLine" id="cb111-17" title="17">f2=<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb111-18" title="18">  <span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</a>
<a class="sourceLine" id="cb111-19" title="19">}</a>
<a class="sourceLine" id="cb111-20" title="20">f<span class="fl">.4</span>=<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb111-21" title="21">  <span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</a>
<a class="sourceLine" id="cb111-22" title="22">}</a>
<a class="sourceLine" id="cb111-23" title="23">K1=<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb111-24" title="24">n=<span class="kw">length</span>(K1)</a>
<a class="sourceLine" id="cb111-25" title="25">root<span class="fl">.4</span>=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb111-26" title="26"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb111-27" title="27">  k=K1[i]</a>
<a class="sourceLine" id="cb111-28" title="28">  root<span class="fl">.4</span>[i]=<span class="kw">uniroot</span>(f<span class="fl">.4</span>,<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb111-29" title="29">}</a>
<a class="sourceLine" id="cb111-30" title="30"><span class="co">#the roots of 11.5</span></a>
<a class="sourceLine" id="cb111-31" title="31">root</a></code></pre></div>
<pre><code>##  [1] 1.492104 1.533559 1.562745 1.584428 1.601182 1.614529 1.625383 1.634409
##  [9] 1.642028 1.648537 1.654188 1.659121 1.663434 1.667304 1.670732 1.673816
## [17] 1.676604 1.679153 1.681483 1.683594 1.685546 1.687356 1.720599</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="co">#the roots of 11.4</span></a>
<a class="sourceLine" id="cb113-2" title="2">root<span class="fl">.4</span></a></code></pre></div>
<pre><code>##  [1]  1.492105  1.533565  1.562774  1.584429  1.601210  1.614520  1.625383
##  [8]  1.634421  1.642056  1.648526  1.654168  1.659095  1.663433  1.667281
## [15]  1.670725  1.673824  1.676639  1.679154  1.681472  1.683596  1.685550
## [22]  1.687355  1.720600 12.180340 16.811388</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="co"># abo</span></a>
<a class="sourceLine" id="cb115-2" title="2">N=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb115-3" title="3"><span class="co"># max. number of the iteration</span></a>
<a class="sourceLine" id="cb115-4" title="4">n1=<span class="dv">28</span>;n2=<span class="dv">24</span>;n3=<span class="dv">41</span>;n4=<span class="dv">70</span></a>
<a class="sourceLine" id="cb115-5" title="5">L=<span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb115-6" title="6"><span class="co"># initial estimates </span></a>
<a class="sourceLine" id="cb115-7" title="7">tol=.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb115-8" title="8">L.old=L<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb115-9" title="9">E=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb115-10" title="10"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb115-11" title="11">  E[j]=<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>n1<span class="op">*</span><span class="kw">log</span>(L[<span class="dv">1</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>n2<span class="op">*</span><span class="kw">log</span>(L[<span class="dv">2</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n3<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>])<span class="op">+</span>n1<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">+</span>n2<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">+</span>n4<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>L[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb115-12" title="12">  model=<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb115-13" title="13">    F1=<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>n1<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>n3<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">+</span>n1<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">-</span>n2<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>n4<span class="op">/</span>x[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb115-14" title="14">    F2=<span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>n2<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>n3<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">-</span>n1<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>n2<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">-</span>x[<span class="dv">1</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>n4<span class="op">/</span>x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb115-15" title="15">    <span class="kw">c</span>(<span class="dt">F1=</span>F1,<span class="dt">F2=</span>F2)</a>
<a class="sourceLine" id="cb115-16" title="16">  }</a>
<a class="sourceLine" id="cb115-17" title="17">  ss=<span class="kw">multiroot</span>(<span class="dt">f=</span>model,<span class="dt">star=</span><span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb115-18" title="18">  L=ss<span class="op">$</span>root</a>
<a class="sourceLine" id="cb115-19" title="19">  <span class="co"># update p and q</span></a>
<a class="sourceLine" id="cb115-20" title="20">  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(L<span class="op">-</span>L.old)<span class="op">/</span>L.old)<span class="op">&lt;</span>tol) <span class="cf">break</span></a>
<a class="sourceLine" id="cb115-21" title="21">  L.old=L</a>
<a class="sourceLine" id="cb115-22" title="22">}</a>
<a class="sourceLine" id="cb115-23" title="23">L.old</a></code></pre></div>
<pre><code>## [1] 0.3273442 0.3104267</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">plot</span>(E,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> hw 12.13 R loops and apply.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="co"># 3</span></a>
<a class="sourceLine" id="cb118-2" title="2">mpg=mtcars<span class="op">$</span>mpg</a>
<a class="sourceLine" id="cb118-3" title="3"> disp=mtcars<span class="op">$</span>disp</a>
<a class="sourceLine" id="cb118-4" title="4"> wt=mtcars<span class="op">$</span>wt</a>
<a class="sourceLine" id="cb118-5" title="5"> formulas=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb118-6" title="6">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb118-7" title="7">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb118-8" title="8">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb118-9" title="9">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</a>
<a class="sourceLine" id="cb118-10" title="10"> n=<span class="dv">4</span>;mod=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb118-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){mod[i]=<span class="kw">lm</span>(formulas[[i]])}</a>
<a class="sourceLine" id="cb118-12" title="12">mod</a></code></pre></div>
<pre><code>## [[1]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[2]]
## (Intercept)   I(1/disp) 
##    10.75202  1557.67393 
## 
## [[3]]
## (Intercept)        disp          wt 
## 34.96055404 -0.01772474 -3.35082533 
## 
## [[4]]
## (Intercept)   I(1/disp)          wt 
##   19.024206 1142.559975   -1.797649</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i)<span class="kw">lm</span>(formulas[[i]]))</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="co"># 4</span></a>
<a class="sourceLine" id="cb122-2" title="2">bootstraps=<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb122-3" title="3">  rows=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb122-4" title="4">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb122-5" title="5">})</a>
<a class="sourceLine" id="cb122-6" title="6"><span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.66981     -0.04031  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.91181     -0.04013  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.39464     -0.04515  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.18795     -0.03122  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     27.1787      -0.0323  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.82595     -0.03778  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.61119     -0.03941  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.71999     -0.04257  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.07399     -0.03936  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    32.79899     -0.05164</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1">n=<span class="dv">10</span>;model=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb124-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb124-3" title="3">  data=<span class="kw">data.frame</span>(bootstraps[[i]])</a>
<a class="sourceLine" id="cb124-4" title="4">  model[i]=<span class="kw">lm</span>(data<span class="op">$</span>mpg<span class="op">~</span>data<span class="op">$</span>disp)</a>
<a class="sourceLine" id="cb124-5" title="5">}</a>
<a class="sourceLine" id="cb124-6" title="6">model</a></code></pre></div>
<pre><code>## [[1]]
## (Intercept)   data$disp 
## 29.66981431 -0.04030816 
## 
## [[2]]
## (Intercept)   data$disp 
## 28.91181209 -0.04012886 
## 
## [[3]]
## (Intercept)   data$disp 
##  31.3946445  -0.0451456 
## 
## [[4]]
## (Intercept)   data$disp 
## 28.18795327 -0.03122119 
## 
## [[5]]
## (Intercept)   data$disp 
## 27.17873996 -0.03229687 
## 
## [[6]]
## (Intercept)   data$disp 
## 28.82595093 -0.03778174 
## 
## [[7]]
## (Intercept)   data$disp 
## 30.61118735 -0.03940851 
## 
## [[8]]
## (Intercept)   data$disp 
## 30.71999127 -0.04256845 
## 
## [[9]]
## (Intercept)   data$disp 
##  29.0739866  -0.0393601 
## 
## [[10]]
## (Intercept)   data$disp 
## 32.79898984 -0.05164229</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="co"># 5</span></a>
<a class="sourceLine" id="cb126-2" title="2">mpg=mtcars<span class="op">$</span>mpg</a>
<a class="sourceLine" id="cb126-3" title="3"> disp=mtcars<span class="op">$</span>disp</a>
<a class="sourceLine" id="cb126-4" title="4"> wt=mtcars<span class="op">$</span>wt</a>
<a class="sourceLine" id="cb126-5" title="5"> formulas=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb126-6" title="6">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb126-7" title="7">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb126-8" title="8">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb126-9" title="9">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</a>
<a class="sourceLine" id="cb126-10" title="10">mod=<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i)<span class="kw">lm</span>(formulas[[i]]))</a>
<a class="sourceLine" id="cb126-11" title="11"><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i)<span class="kw">summary</span>(mod[[i]])<span class="op">$</span>r.squared)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">bootstraps=<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb128-2" title="2">  rows=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb128-3" title="3">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb128-4" title="4">})</a>
<a class="sourceLine" id="cb128-5" title="5">Mod=<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</a>
<a class="sourceLine" id="cb128-6" title="6"><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="cf">function</span>(i)<span class="kw">summary</span>(Mod[[i]])<span class="op">$</span>r.squared)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7129334
## 
## [[2]]
## [1] 0.744549
## 
## [[3]]
## [1] 0.6936839
## 
## [[4]]
## [1] 0.7915925
## 
## [[5]]
## [1] 0.7936962
## 
## [[6]]
## [1] 0.6612054
## 
## [[7]]
## [1] 0.7692478
## 
## [[8]]
## [1] 0.6288038
## 
## [[9]]
## [1] 0.6250162
## 
## [[10]]
## [1] 0.6763515</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="co"># 3</span></a>
<a class="sourceLine" id="cb130-2" title="2">trials=<span class="kw">replicate</span>(<span class="dv">100</span>,<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),<span class="dt">simplify =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb130-3" title="3"><span class="kw">sapply</span>(trials,<span class="st">&quot;[[&quot;</span>,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   [1] 0.41609220 0.14535987 0.65978424 0.64120216 0.08264686 0.10490691
##   [7] 0.18090917 0.48372378 0.18476524 0.16927911 0.35902245 0.07625683
##  [13] 0.35652725 0.91832566 0.16654980 0.70993015 0.12533206 0.59239274
##  [19] 0.84730221 0.13526221 0.87210135 0.41865920 0.08055601 0.30555384
##  [25] 0.04984081 0.26007685 0.28789889 0.26838295 0.45295550 0.10584220
##  [31] 0.30025107 0.07729290 0.55705517 0.53116267 0.36415499 0.45850766
##  [37] 0.31925684 0.95937902 0.09072670 0.35332333 0.56494200 0.26675641
##  [43] 0.31863958 0.99182577 0.28143600 0.90534091 0.75814176 0.64710526
##  [49] 0.41452911 0.57654326 0.27106453 0.54477276 0.96351213 0.64501701
##  [55] 0.17500469 0.05700096 0.22569745 0.33750281 0.38987357 0.88846270
##  [61] 0.63770834 0.19096285 0.21080009 0.54462900 0.37263642 0.27456549
##  [67] 0.91338256 0.03956460 0.35218639 0.48082305 0.68946054 0.85934491
##  [73] 0.68644905 0.60928371 0.24602031 0.47947475 0.17879993 0.85073976
##  [79] 0.18189200 0.78596329 0.40370307 0.78976339 0.20561163 0.88070269
##  [85] 0.52322759 0.39812291 0.15867931 0.36083980 0.13891953 0.73707857
##  [91] 0.93663502 0.31855308 0.25119744 0.19184044 0.60154231 0.69934593
##  [97] 0.44498445 0.11197504 0.88104640 0.10642174</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1">p=<span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb132-2" title="2">  p.value=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb132-3" title="3">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb132-4" title="4">    result=trials[[i]]</a>
<a class="sourceLine" id="cb132-5" title="5">    p.value[i]=result<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb132-6" title="6">  }</a>
<a class="sourceLine" id="cb132-7" title="7">  p.value</a>
<a class="sourceLine" id="cb132-8" title="8">}</a>
<a class="sourceLine" id="cb132-9" title="9"><span class="kw">p</span>(<span class="dv">100</span>)</a></code></pre></div>
<pre><code>##   [1] 0.41609220 0.14535987 0.65978424 0.64120216 0.08264686 0.10490691
##   [7] 0.18090917 0.48372378 0.18476524 0.16927911 0.35902245 0.07625683
##  [13] 0.35652725 0.91832566 0.16654980 0.70993015 0.12533206 0.59239274
##  [19] 0.84730221 0.13526221 0.87210135 0.41865920 0.08055601 0.30555384
##  [25] 0.04984081 0.26007685 0.28789889 0.26838295 0.45295550 0.10584220
##  [31] 0.30025107 0.07729290 0.55705517 0.53116267 0.36415499 0.45850766
##  [37] 0.31925684 0.95937902 0.09072670 0.35332333 0.56494200 0.26675641
##  [43] 0.31863958 0.99182577 0.28143600 0.90534091 0.75814176 0.64710526
##  [49] 0.41452911 0.57654326 0.27106453 0.54477276 0.96351213 0.64501701
##  [55] 0.17500469 0.05700096 0.22569745 0.33750281 0.38987357 0.88846270
##  [61] 0.63770834 0.19096285 0.21080009 0.54462900 0.37263642 0.27456549
##  [67] 0.91338256 0.03956460 0.35218639 0.48082305 0.68946054 0.85934491
##  [73] 0.68644905 0.60928371 0.24602031 0.47947475 0.17879993 0.85073976
##  [79] 0.18189200 0.78596329 0.40370307 0.78976339 0.20561163 0.88070269
##  [85] 0.52322759 0.39812291 0.15867931 0.36083980 0.13891953 0.73707857
##  [91] 0.93663502 0.31855308 0.25119744 0.19184044 0.60154231 0.69934593
##  [97] 0.44498445 0.11197504 0.88104640 0.10642174</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="co"># 7</span></a>
<a class="sourceLine" id="cb134-2" title="2"><span class="kw">library</span>(parallelsugar)</a>
<a class="sourceLine" id="cb134-3" title="3">mpg=mtcars<span class="op">$</span>mpg</a>
<a class="sourceLine" id="cb134-4" title="4"> disp=mtcars<span class="op">$</span>disp</a>
<a class="sourceLine" id="cb134-5" title="5"> wt=mtcars<span class="op">$</span>wt</a>
<a class="sourceLine" id="cb134-6" title="6"> formulas=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb134-7" title="7">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb134-8" title="8">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb134-9" title="9">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb134-10" title="10">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</a>
<a class="sourceLine" id="cb134-11" title="11">mod=<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i)<span class="kw">lm</span>(formulas[[i]]))</a>
<a class="sourceLine" id="cb134-12" title="12"><span class="kw">mclapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i)<span class="kw">summary</span>(mod[[i]])<span class="op">$</span>r.squared,<span class="dt">mc.cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<p>hw 12.20 use R to do this exercise，first,we creat two functions of the 9.4 and here is a example when sigma=10,x0=1 and N=10000.use ggplot2,we know the results are same.Campare the computation time of the two functions with microbenchmark,we know the rcpp is faster.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1">N=<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb136-2" title="2">df=<span class="cf">function</span>(x)(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb136-3" title="3">rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb136-4" title="4">x=<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb136-5" title="5">x[<span class="dv">1</span>] =<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb136-6" title="6">u=<span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb136-7" title="7">k =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb136-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb136-9" title="9">y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb136-10" title="10"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">df</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">df</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb136-11" title="11">x[i] =<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb136-12" title="12">x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb136-13" title="13">k =<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb136-14" title="14">}</a>
<a class="sourceLine" id="cb136-15" title="15">}</a>
<a class="sourceLine" id="cb136-16" title="16"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb136-17" title="17">}</a>
<a class="sourceLine" id="cb136-18" title="18"><span class="co"># rcpp</span></a>
<a class="sourceLine" id="cb136-19" title="19"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb136-20" title="20"><span class="kw">cppFunction</span>(<span class="st">&#39;List RwMetropolis(double sigma, double x0, int N) {</span></a>
<a class="sourceLine" id="cb136-21" title="21"><span class="st">NumericVector x(N);</span></a>
<a class="sourceLine" id="cb136-22" title="22"><span class="st">x[0] = x0;</span></a>
<a class="sourceLine" id="cb136-23" title="23"><span class="st">NumericVector u=runif(N);</span></a>
<a class="sourceLine" id="cb136-24" title="24"><span class="st">int k = 0;</span></a>
<a class="sourceLine" id="cb136-25" title="25"><span class="st">for (int i=1;i&lt;N;i++) {</span></a>
<a class="sourceLine" id="cb136-26" title="26"><span class="st">double y = rnorm(1, x[i-1], sigma)[0];</span></a>
<a class="sourceLine" id="cb136-27" title="27"><span class="st">if (u[i] &lt;= exp2(abs(x[i-1])-abs(y))){</span></a>
<a class="sourceLine" id="cb136-28" title="28"><span class="st">x[i] = y; }</span></a>
<a class="sourceLine" id="cb136-29" title="29"><span class="st">else {</span></a>
<a class="sourceLine" id="cb136-30" title="30"><span class="st">x[i] = x[i-1];</span></a>
<a class="sourceLine" id="cb136-31" title="31"><span class="st">k += 1;</span></a>
<a class="sourceLine" id="cb136-32" title="32"><span class="st">}</span></a>
<a class="sourceLine" id="cb136-33" title="33"><span class="st">}</span></a>
<a class="sourceLine" id="cb136-34" title="34"><span class="st">return List::create(</span></a>
<a class="sourceLine" id="cb136-35" title="35"><span class="st">    _[&quot;x&quot;] = x,</span></a>
<a class="sourceLine" id="cb136-36" title="36"><span class="st">    _[&quot;k&quot;] = k</span></a>
<a class="sourceLine" id="cb136-37" title="37"><span class="st">  );</span></a>
<a class="sourceLine" id="cb136-38" title="38"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb136-39" title="39"><span class="co"># qqplot</span></a>
<a class="sourceLine" id="cb136-40" title="40">v1=<span class="kw">rw.Metropolis</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">1e3</span>)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb136-41" title="41">v2=<span class="kw">RwMetropolis</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">1e3</span>)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb136-42" title="42"><span class="kw">library</span>(qqplotr)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：ggplot2</code></pre>
<pre><code>## 
## 载入程辑包：&#39;ggplot2&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     mpg</code></pre>
<pre><code>## 
## 载入程辑包：&#39;qqplotr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     stat_qq_line, StatQqLine</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1"><span class="kw">qqplot</span>(v1,v2)</a>
<a class="sourceLine" id="cb142-2" title="2"><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="co"># compare time</span></a>
<a class="sourceLine" id="cb143-2" title="2"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb143-3" title="3">ts=<span class="kw">microbenchmark</span>(<span class="kw">rw.Metropolis</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">1e3</span>),<span class="kw">RwMetropolis</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">1e3</span>))</a>
<a class="sourceLine" id="cb143-4" title="4"><span class="kw">summary</span>(ts)</a></code></pre></div>
<pre><code>##                          expr    min       lq     mean   median        uq
## 1 rw.Metropolis(10, 10, 1000) 2811.5 2856.051 3341.838 2893.951 3022.2010
## 2  RwMetropolis(10, 10, 1000)  138.4  142.801  160.295  145.601  150.8005
##         max neval
## 1 10489.300   100
## 2  1373.501   100</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
